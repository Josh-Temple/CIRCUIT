<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
    <!-- Security Headers -->
    <!-- CSP: Added 'blob:' and 'data:' to script-src to allow sandboxed execution -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' blob: data: https://cdn.tailwindcss.com https://esm.sh https://*.esm.sh;
      style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
      font-src 'self' data: https://fonts.gstatic.com https://fonts.googleapis.com;
      img-src 'self' data: blob: https://lh3.googleusercontent.com https://*.googleusercontent.com;
      connect-src 'self' https://esm.sh https://*.esm.sh data:;
      worker-src 'self' blob:;
      object-src 'none';
      base-uri 'self';
      form-action 'self';
    ">
    <!-- Prevents MIME type sniffing -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <!-- Controls how much referrer information is included with requests -->
    <meta name="referrer" content="strict-origin-when-cross-origin">

    <title>CIRCUIT</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;700;800&family=Noto+Sans:wght@400;700&family=Racing+Sans+One&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#FAF0E6">
    <style>
        body {
            font-family: 'Manrope', sans-serif;
            -webkit-tap-highlight-color: transparent;
            background-color: #FAF0E6; /* matching background-light */
        }
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        /* Custom animations */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-4px); }
            75% { transform: translateX(4px); }
        }
        .animate-shake {
            animation: shake 0.2s ease-in-out 2;
        }
    </style>
    <script>
        // Global error handler for startup issues
        window.onerror = function(msg, url, lineNo, columnNo, error) {
            const root = document.getElementById('root');
            if (root && root.innerHTML === '') {
                root.innerHTML = '<div style="padding:20px; color:#c00;"><h2>Startup Error</h2><p>' + msg + '</p></div>';
            }
            console.error('Global Error:', msg, error);
            return false;
        };

        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#ADD8E6", // Light Blue
                        "primary-dark": "#8FBCCD", // Slightly darker blue
                        "sage": "#9AC1D0", // Muted Blue (used for 'correct' state)
                        "clay": "#FA8072", // Coral (used for 'error' state)
                        "terracotta": "#FA8072", // Coral (Accent)
                        "background-light": "#FAF0E6", // Linen
                        "background-dark": "#20231f",
                        "soft-gray": "#E0D8BE", // Surface
                        "stone-100": "#F2EBE0", // Light Surface
                        "stone-200": "#E0D8BE", // Surface
                        "slate-900": "#4A3833", // Dark Brown Text
                        "slate-800": "#5D4B46",
                        "gray-500": "#8D7B75", // Secondary Text
                        "gray-400": "#A8958E", // Muted Text
                        "gray-300": "#C4B4AE",
                        "gray-200": "#DBCBC5", // Divider
                        "white": "#FFFFFF",
                    },
                    fontFamily: {
                        "display": ["Racing Sans One", "cursive"],
                        "sans": ["Manrope", "sans-serif"]
                    },
                    boxShadow: {
                        "whisper": "0 4px 20px -2px rgba(74, 56, 51, 0.05)",
                        "soft": "0 4px 20px rgba(173, 216, 230, 0.2)",
                    }
                },
            },
        }
    </script>
  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react/": "https://esm.sh/react@18.2.0/",
    "react-dom": "https://esm.sh/react-dom@18.2.0",
    "react-dom/": "https://esm.sh/react-dom@18.2.0/",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "recharts": "https://esm.sh/recharts@2.12.0?external=react,react-dom",
    "dexie": "https://esm.sh/dexie@4.0.1",
    "dexie-react-hooks": "https://esm.sh/dexie-react-hooks@1.1.7?external=react,dexie"
  }
}
</script>
</head>
  <body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-white min-h-[100dvh]">
    <div id="root"></div>
    <script type="module" src="./index.tsx"></script>
  </body>
</html>